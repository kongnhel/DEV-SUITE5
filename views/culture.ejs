<%- include('partials/header') %>

<style>
    :root {
        --royal-gold: <%= theme %>; /* á–ááŸŒá˜á¶áŸáŠáŸ‚á›á”á¶á‰áŸ‹á…áŸá‰á–á¸ Controller */
        --deep-bronze: #8b4513;
        --bg: #0a0a0a;
    }
    body {
        font-family: "Kantumruy Pro", sans-serif;
        background: var(--bg);
        color: #f3f4f6;
        font-size: 16px;
        overflow-x: hidden;
    }

    /* === MARKETING HERO STYLE === */
    .hero-gold-glow {
        background: radial-gradient(circle at center, rgba(212, 175, 55, 0.15) 0%, transparent 70%);
    }
    .heritage-badge {
        background: rgba(212, 175, 55, 0.1);
        border: 1px solid rgba(212, 175, 55, 0.3);
        color: var(--royal-gold);
        padding: 6px 16px;
        border-radius: 99px;
        font-size: 11px;
        font-weight: 800;
        letter-spacing: 0.2em;
    }

    /* Royal Elements */
    .bg-royal {
        position: fixed;
        inset: 0;
        background: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #050505 100%);
        z-index: -20;
    }
    .bg-pattern {
        position: fixed;
        inset: 0;
        background-image: url("https://www.transparenttextures.com/patterns/pinstriped-suit.png");
        opacity: 0.05;
        z-index: -10;
    }

    .gold-glow-card {
        background: rgba(20, 20, 20, 0.7);
        backdrop-filter: blur(30px);
        border: 1px solid rgba(212, 175, 55, 0.2);
        border-radius: 40px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .gold-glow-card:hover {
        border-color: var(--royal-gold);
        transform: translateY(-5px);
    }

    .btn-khmer {
        background: linear-gradient(135deg, #b8860b 0%, #ffd700 50%, #b8860b 100%);
        background-size: 200% auto;
        color: #000;
        font-weight: 800;
        box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
        transition: 0.5s;
    }
    .btn-khmer:hover {
        background-position: right center;
        box-shadow: 0 0 50px rgba(212, 175, 55, 0.5);
        transform: scale(1.02);
    }

    .shimmer-gold {
        background: linear-gradient(to bottom, #ffd700, #b8860b);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-family: "Freehand", cursive;
    }

    .no-scrollbar::-webkit-scrollbar { display: none; }
</style>

<div class="bg-royal"></div>
<div class="bg-pattern"></div>
<div class="hero-gold-glow fixed inset-0 -z-10"></div>

<main class="max-w-6xl mx-auto p-4 md:p-12 relative">
    
    <header class="text-center mb-16 space-y-8 animate-in fade-in zoom-in duration-1000">
        <div class="flex justify-center">
            <span class="heritage-badge uppercase">Ancient Wisdom x Neural AI</span>
        </div>
        
        <h2 class="text-6xl md:text-9xl font-bold shimmer-gold leading-none pb-4">
            á˜á‚áŸ’á‚á»á‘áŸ’á‘áŸáŸá€áŸáœá”áŸ’á”á’á˜áŸŒááŸ’á˜áŸ‚áš
        </h2>
        
        <div class="max-w-3xl mx-auto space-y-6">
            <p class="text-2xl md:text-4xl font-light text-white leading-tight">
                "á”á¾á€á€áŸ’ášá¶áŸ†á„á˜á¶áŸá“áŸƒá”áŸ’ášáœááŸ’áá·áŸá¶áŸáŸ’ááŸ’ášááŸ’á˜áŸ‚áš áá¶á˜ášá™áŸˆá”á‰áŸ’á‰á¶áŸá·á”áŸ’á”á“á·á˜áŸ’á˜á·á!"
            </p>
            <p class="text-lg md:text-xl text-slate-400 font-light italic leading-relaxed px-4">
                áˆá”áŸ‹á”á¶ášá˜áŸ’á—ášá¿á„á¢á¶á“áŸáŸ€áœá—áŸ…á€áŸ’ášá¶áŸáŸ‹áŸ—! AI ášá”áŸáŸ‹á™á¾á„á“á¹á„á“á¶áŸ†á¢áŸ’á“á€á‘áŸ…á€á¶á“áŸ‹ <span class="text-yellow-500 font-bold">á™á»á‚áŸá˜áŸá™á¢á„áŸ’á‚áš</span> áœá·á‰ á‡á¶á˜á½á™á€á¶ášá–á“áŸ’á™á›áŸ‹áŠáŸáŸáŸŠá¸á‡á˜áŸ’ášáŸ… á“á·á„á€áŸ†á”áŸ’á›áŸ‚á„áŸ—áŸ” á…á„áŸ‹áŠá¹á„á¢á¸á–á¸áœá”áŸ’á”á’á˜áŸŒááŸ’á˜áŸ‚áš áŸá½ášá—áŸ’á›á¶á˜ á†áŸ’á›á¾á™á—áŸ’á›áŸ‚á áŠá¼á…á˜á¶á“ <span class="text-yellow-500 font-bold">á‚áŸ’ášá¼á”áŸ’ášáœááŸ’áá·áŸá¶áŸáŸ’ááŸ’ášá•áŸ’á‘á¶á›áŸ‹ááŸ’á›á½á“</span> áá¶á˜á‡á¶á”áŸ‹ááŸ’á›á½á“á¢áŸŠá¸á…á¹á„! ğŸ˜‚
            </p>
        </div>

        <div class="flex flex-wrap justify-center gap-10 pt-6">
            <div class="text-center">
                <span class="text-3xl block mb-2">ğŸ¯</span>
                <p class="text-[10px] font-black text-yellow-600 uppercase tracking-widest">Heritage Expert</p>
            </div>
            <div class="text-center border-x border-white/10 px-10">
                <span class="text-3xl block mb-2">ğŸ“œ</span>
                <p class="text-[10px] font-black text-yellow-600 uppercase tracking-widest">Ancient Archive</p>
            </div>
            <div class="text-center">
                <span class="text-3xl block mb-2">ğŸ’</span>
                <p class="text-[10px] font-black text-yellow-600 uppercase tracking-widest">Royal Cyber Design</p>
            </div>
        </div>
    </header>

    <div class="grid grid-cols-1 gap-12">
        <div class="gold-glow-card p-8 md:p-16 relative overflow-hidden">
            <div class="absolute -top-20 -left-20 w-64 h-64 bg-yellow-500/5 blur-[100px] -z-10"></div>

            <div class="flex items-center gap-4 mb-10">
                <div class="bg-yellow-500/10 p-4 rounded-3xl border border-yellow-500/20">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#d4af37" stroke-width="2">
                        <path d="M12 21l-8-4V7l8-4 8 4v10l-8 4z" />
                    </svg>
                </div>
                <div>
                    <h3 class="text-2xl font-bold text-yellow-200 uppercase tracking-tight italic">á”á‰áŸ’á…áŸá‰á…á˜áŸ’á„á›áŸ‹ášá”áŸáŸ‹á¢áŸ’á“á€</h3>
                    <p class="text-xs text-slate-500 font-mono">NEURAL_HERITAGE_SYNC_PROTOCOL</p>
                </div>
            </div>

            <textarea
                id="questionInput"
                class="w-full h-40 md:h-56 bg-black/40 border border-white/10 rounded-[30px] p-8 focus:ring-4 focus:ring-yellow-500/20 outline-none text-xl md:text-2xl leading-relaxed text-slate-100 transition-all placeholder:text-slate-700 mb-10 shadow-inner"
                placeholder="á§á‘á¶á ášááŸáŸ– áá¾á”áŸ’ášá¶áŸá¶á‘á¢á„áŸ’á‚ášáœááŸ’áááŸ’ášá¼áœá”á¶á“á€áŸá¶á„á¡á¾á„á€áŸ’á“á»á„á‚áŸ„á›á”áŸ†áá„á¢áŸ’áœá¸?"></textarea>

            <div class="flex flex-col lg:flex-row items-center justify-between gap-10">
                <div class="w-full lg:w-1/2">
                    <label class="block text-[11px] font-black text-yellow-600 uppercase tracking-[0.3em] mb-4 ml-4">á”áŸ’ášá—áŸá‘á“áŸƒá€á¶ášá”á€áŸáŸ’ášá¶á™ (Style)</label>
                    <select id="answerType" class="w-full bg-black/60 border border-yellow-500/20 rounded-full px-8 py-5 text-lg text-yellow-200 outline-none focus:border-yellow-500 transition appearance-none cursor-pointer">
                        <option value="brief">âœ¨ áŸá„áŸ’ááŸá”ááŸ’á›á¸ ááŸ’á›á¹á˜ (Brief Wisdom)</option>
                        <option value="detailed">ğŸ“œ á–á“áŸ’á™á›áŸ‹á›á˜áŸ’á¢á·á (Ancient Archives)</option>
                    </select>
                </div>

                <button onclick="askAI()" id="btnAsk" class="btn-khmer px-14 py-6 rounded-full text-xl shadow-2xl active:scale-95 flex items-center gap-4 w-full lg:w-auto justify-center tracking-widest uppercase">
                    <span>áŸá¶á€áŸá½ášá¢áŸ’á“á€á‡áŸ†á“á¶á‰ AI</span>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                        <path d="M5 12h14m-7-7l7 7-7 7" />
                    </svg>
                </button>
            </div>
        </div>

        <div id="loading" class="hidden py-24 text-center">
            <div class="inline-block relative">
                <div class="w-24 h-24 border-8 border-yellow-500/10 border-t-yellow-500 rounded-full animate-spin"></div>
                <div class="absolute inset-0 flex items-center justify-center text-4xl">ğŸ“œ</div>
            </div>
            <p class="mt-8 text-yellow-500 text-sm font-black animate-pulse tracking-[0.5em] uppercase">
                á€áŸ†á–á»á„á”á¾á€á€áŸ’ášá¶áŸ†á„áŸáŸ’ášá¶áœá‡áŸ’ášá¶áœáŠáŸáœá·áŸá»á‘áŸ’á’...
            </p>
        </div>

        <div id="responseSection" class="hidden space-y-8 animate-in slide-in-from-bottom-10 duration-1000">
            <div class="gold-glow-card p-10 md:p-16 border-l-[15px] border-yellow-600 relative overflow-hidden">
                <div class="absolute -bottom-10 -right-10 text-[180px] opacity-[0.03] rotate-12">ğŸ¯</div>

                <div class="flex items-center justify-between mb-10 border-b border-white/5 pb-6">
                    <span id="responseBadge" class="text-[10px] md:text-xs font-black tracking-[0.4em] text-yellow-600 uppercase">ARCHIVE_RECORD</span>
                    <button onclick="window.print()" class="text-[10px] font-black text-slate-500 hover:text-white transition uppercase tracking-widest border border-white/10 px-6 py-2 rounded-full">
                        SAVE_FOR_GENERATION
                    </button>
                </div>

                <div class="flex gap-6 relative z-10">
                    <div class="hidden sm:block text-5xl md:text-7xl opacity-40 text-yellow-500 leading-none">â€œ</div>
                    <div id="responseText" class="text-slate-100 leading-[1.8] text-2xl md:text-4xl font-light italic pr-10"></div>
                </div>
            </div>
            
            <div class="text-center p-8 bg-yellow-500/5 rounded-full border border-yellow-500/10">
                <p class="text-xs text-yellow-600 font-mono tracking-widest uppercase">Ancient Wisdom Syncing Completed Successfully</p>
            </div>
        </div>
    </div>
</main>

<%- include('partials/footer') %>

<script>
    const socket = io();

    function askAI() {
        const question = document.getElementById("questionInput").value.trim();
        const type = document.getElementById("answerType").value;

        if (!question) return Swal.fire({ 
            icon: "question", 
            title: "á…á„áŸ‹áŠá¹á„á¢á¸á‚áŸá”áŸ’á¢á¼á“?", 
            text: "á”á„ AI á˜á·á“á˜áŸ‚á“á‚áŸ’ášá¼á‘á¶á™á‘áŸáá¶ áŠá¶á€áŸ‹áŸáŸ†áá½ášá˜á€á”áŸ’á¢á¼á“! ğŸ˜‚", 
            background: "#0a0a0a", color: "#ffd700" 
        });

        document.getElementById("loading").classList.remove("hidden");
        document.getElementById("responseSection").classList.add("hidden");
        document.getElementById("btnAsk").disabled = true;
        document.getElementById("btnAsk").style.opacity = "0.5";

        socket.emit("ask_culture", { question, type });
    }

    socket.on("culture_result", (data) => {
        document.getElementById("loading").classList.add("hidden");
        document.getElementById("responseSection").classList.remove("hidden");
        document.getElementById("btnAsk").disabled = false;
        document.getElementById("btnAsk").style.opacity = "1";

        const type = document.getElementById("answerType").value;
        document.getElementById("responseBadge").innerText = type === "brief" ? "BRIEF_SUMMARY_SYNC" : "DETAILED_ARCHIVE_SYNC";

        typeWriter("responseText", data.response);
    });

    function typeWriter(id, text) {
        let i = 0; const el = document.getElementById(id); el.innerHTML = "";
        function type() { if (i < text.length) { el.innerHTML += text.charAt(i); i++; setTimeout(type, 15); } }
        type();
    }

    socket.on("error_occured", (msg) => {
        Swal.fire({ icon: "error", title: "á”áŸ’ášá–áŸá“áŸ’á’á˜á¶á“á”á‰áŸ’á á¶!", text: msg, background: "#0a0a0a", color: "#fff" });
        document.getElementById("loading").classList.add("hidden");
        document.getElementById("btnAsk").disabled = false;
    });
</script>